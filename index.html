const startTimes = {}; // Track start times for each question
const responseTimes = {}; // Store response times for submission
const nameInput = document.getElementById('nameInput');

// Clear response tracking when a new name is entered
nameInput.addEventListener('input', () => {
  for (const key in startTimes) {
    delete startTimes[key];
  }
  for (const key in responseTimes) {
    delete responseTimes[key];
  }
  console.log("Reset timers for new respondent:", nameInput.value);
});

// Track the start time of each question when the user selects an answer
document.querySelectorAll('input[type="radio"]').forEach((radio) => {
  radio.addEventListener('change', (event) => {
    const questionId = event.target.name;
    if (!startTimes[questionId]) {
      startTimes[questionId] = Date.now();
    }
  });
});

// Submit form data
document.getElementById('submitBtn').addEventListener('click', async () => {
  const participantName = nameInput.value.trim();

  if (!participantName) {
    alert('Please enter your name before submitting.');
    return;
  }

  Object.keys(startTimes).forEach((questionId) => {
    responseTimes[questionId] = ((Date.now() - startTimes[questionId]) / 1000).toFixed(2);
  });

  const formData = {
    name: participantName,
    q1Time: responseTimes['q1'] || 'N/A',
    q2Time: responseTimes['q2'] || 'N/A',
  };

  // Send data to Google Sheets
  const response = await fetch('YOUR_WEB_APP_URL_HERE', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(formData),
  });

  const result = await response.json();
  if (result.result === 'success') {
    alert(`Thank you, ${participantName}! Your responses have been recorded.`);
  } else {
    alert('Something went wrong. Please try again.');
  }

  console.log('Submitted Data:', formData);
});
